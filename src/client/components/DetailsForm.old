import { FormControl, FormLabel, Input } from '@chakra-ui/react'
import { useState } from 'react'
import { dateToString } from '../util/utils'
import { Employee } from '../value_objects/Employee'
import {
    useEmployeeStore,
    useSelectedEmployeeStore,
    useSettingsStore,
} from './RootStoreProvider'

export const DetailsForm = ({
    updateEmployee,
}: {
    updateEmployee: (Employee) => Promise<string>
}) => {
    const employeeStore = useEmployeeStore()
    const selectedEmployeeStore = useSelectedEmployeeStore()
    const settingsStore = useSettingsStore()

    const [first, setFirst] = useState<string>(
        employeeStore.getEmployee(selectedEmployeeStore.selectedId).first
    )

    const [last, setLast] = useState<string>(
        employeeStore.getEmployee(selectedEmployeeStore.selectedId).last
    )

    const controlStyle = { margin: '16px' }
    const DetailsInput = ({
        label,
        value,
        handleChange,
    }: {
        label: string
        value: string
        handleChange: (event) => void
    }) => {
        return (
            <FormControl style={controlStyle} variant="floating">
                <FormLabel>{label}</FormLabel>
                <Input value={value} onChange={handleChange}></Input>
            </FormControl>
        )
    }

    employeeStore.getEmployee(selectedEmployeeStore.selectedId)

    const pickerStyle = {
        border: '1px solid lightgrey',
        padding: '5px',
        borderRadius: '5px',
    }
    return (
        <>
            <DetailsInput
                label="first name"
                value={first}
                handleChange={(event) => setFirst(event.target.value)}
            />

            <DetailsInput
                label="last name"
                value={last}
                handleChange={(event) => setLast(event.target.value)}
            />
            <FormControl style={controlStyle} variant="floating">
                <FormLabel>email</FormLabel>
                <Input
                    type={'email'}
                    value={
                        employeeStore.getEmployee(
                            selectedEmployeeStore.selectedId
                        ).email
                    }
                ></Input>
            </FormControl>

            <FormControl style={controlStyle} variant="floating">
                <FormLabel>{'start date'}</FormLabel>
                <input
                    style={pickerStyle}
                    type="date"
                    value={dateToString(
                        employeeStore.getEmployee(
                            selectedEmployeeStore.selectedId
                        ).startDate
                    )}
                />
            </FormControl>
            <DetailsInput
                label="position"
                value={
                    settingsStore.getValueById(
                        employeeStore.getEmployee(
                            selectedEmployeeStore.selectedId
                        ).position
                    ).value
                }
            />
            <DetailsInput
                label="skills"
                value={employeeStore
                    .getEmployee(selectedEmployeeStore.selectedId)
                    .skills.join(',')}
            />
            <DetailsInput
                label="interests"
                value={employeeStore
                    .getEmployee(selectedEmployeeStore.selectedId)
                    .interests.join(',')}
            />
            <DetailsInput
                label="college"
                value={
                    employeeStore.getEmployee(selectedEmployeeStore.selectedId)
                        .college
                }
            />
            <DetailsInput
                label="home town"
                value={
                    employeeStore.getEmployee(selectedEmployeeStore.selectedId)
                        .hometown
                }
            />
            <DetailsInput
                label="current town"
                value={
                    employeeStore.getEmployee(selectedEmployeeStore.selectedId)
                        .townOfResidence
                }
            />
            <FormControl style={controlStyle} variant="floating">
                <FormLabel>{'birth day (month and day)'}</FormLabel>
                <input
                    style={pickerStyle}
                    type="date"
                    // value={dateToString(
                    //     employeeStore.getEmployee(
                    //         selectedEmployeeStore.selectedId
                    //     ).birthMonthDay
                    // )}
                />
            </FormControl>
            <DetailsInput
                label="pets"
                value={employeeStore
                    .getEmployee(selectedEmployeeStore.selectedId)
                    .pets.join(',')}
            />
            <FormControl style={controlStyle} variant="floating">
                <FormLabel>{'additional details'}</FormLabel>
                <Input
                    type="text"
                    value={
                        employeeStore.getEmployee(
                            selectedEmployeeStore.selectedId
                        ).pets
                    }
                />
            </FormControl>
        </>
    )
}
